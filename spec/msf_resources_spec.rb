# -*- coding: utf-8 -*-

require_relative 'spec_helper'

describe 'pentester::msf_resources' do
  let(:subject) do
    ChefSpec::SoloRunner.new do |node|
      node.override['pentester']['msf']['resources'] = { 'myres' => ['load msgrpc'] }
    end.converge(described_recipe)
  end

  it 'creates directory[/root/.msf4/scripts/resource]' do
    expect(subject).to create_directory('/root/.msf4/scripts/resource')
      .with(owner: 'root',
            group: 'root')
  end

  it 'creates template[/root/.msf4/scripts/resource/myres]' do
    expect(subject).to create_template('/root/.msf4/scripts/resource/myres')
      .with(owner: 'root',
            group: 'root',
            source: 'msf/resource.erb')
  end
end
