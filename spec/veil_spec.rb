# -*- coding: utf-8 -*-

require_relative 'spec_helper'

describe 'pentester::veil' do
  let(:subject) do
    ChefSpec::SoloRunner
      .new(platform: 'debian',
           version: '9.0') do |node|
    end.converge(described_recipe)
  end

  it 'creates directory[/opt/veil-framework]' do
    expect(subject).to create_directory('/opt/veil')
  end

  %w(Evasion Catapult Pillage Ordnance).each do |repo|
    it "sync git[/opt/veil/Veil-#{repo}]" do
      expect(subject).to sync_git("/opt/veil/Veil-#{repo}")
        .with(repository: "https://github.com/Veil-Framework/Veil-#{repo}",
              reference: 'master')
    end
  end
end
