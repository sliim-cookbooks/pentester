# -*- coding: utf-8 -*-

require_relative 'spec_helper'

describe 'pentester::itib' do
  let(:subject) do
    ChefSpec::SoloRunner
      .new(platform: 'debian',
           version: '9.0') do |node|
    end.converge(described_recipe)
  end

  it 'installs python_runtime[2]' do
    expect(subject).to install_python_runtime('2')
  end

  it 'creates python_virtualenv[itib-venv]' do
    expect(subject).to create_python_virtualenv('itib-venv')
      .with(path: '/opt/isthisipbad/venv')
  end

  it 'installs python_package[dnspython]' do
    expect(subject).to install_python_package('dnspython')
  end

  it 'sync git[/opt/isthisipbad]' do
    expect(subject).to sync_git('/opt/isthisipbad')
      .with(repository: 'https://github.com/jgamblin/isthisipbad',
            reference: 'master')
  end
end
